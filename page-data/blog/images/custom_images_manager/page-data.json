{"componentChunkName":"component---src-templates-template-blog-post-js","path":"/blog/images/custom_images_manager/","result":{"data":{"zipFile":{"publicURL":"/static/小书匠自定义图床使用说明-9099566810b57d492920d7108d7a24f6.zip"},"pdfFile":null,"site":{"siteMetadata":{"title":"小书匠","siteUrl":"http://www.xiaoshujiang.com"}},"storyWriterMarkdown":{"id":"aa53a2eb-17b9-5c2f-a50f-d1d6d2af0fcc","html":"\n\n\t<div class=\"preview html_preview xsj_export_zip\"><div style=\"overflow: hidden; position: absolute; top: 0; height: 1px; width: auto; padding: 0; border: 0; margin: 0; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;\"><svg><defs id=\"MathJax_SVG_glyphs\"/><defs xmlns=\"http://www.w3.org/2000/svg\"><filter xmlns=\"http://www.w3.org/2000/svg\" id=\"dropshadow\" height=\"130%\">      <fegaussianblur in=\"SourceAlpha\" stddeviation=\"3\"/>       <feoffset dx=\"2\" dy=\"2\" result=\"offsetblur\"/>       <femerge>         <femergenode/>        <femergenode in=\"SourceGraphic\"/>       </femerge>    </filter><filter id=\"editing-stripe-bk\" filterunits=\"userSpaceOnUse\" x=\"-100%\" y=\"-100%\" width=\"300%\" height=\"300%\"><feflood flood-color=\"#700f0f\" result=\"flood1\"/><feflood flood-color=\"#fff\" flood-opacity=\"0.5\" result=\"flood2\"/><feimage xlink:href=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMDAwcHgiIGhlaWdodD0iMTAwMHB4Ij48ZGVmcz48cGF0dGVybiBpZD0icGF0dGVybiIgcGF0dGVyblVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeD0iMCIgeT0iMCIgd2lkdGg9IjQiIGhlaWdodD0iNCI+PHBhdGggZD0iTSAtNCAtNCBMIDggOCBNIC04IC00IEwgNCA4IE0gLTQgLTggTCA4IDQiIHN0cm9rZT0iIzAwMCIgc3Ryb2tlLXdpZHRoPSIxIi8+PC9wYXR0ZXJuPjwvZGVmcz48cmVjdCB4PSIwIiB5PSIwIiB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJ1cmwoI3BhdHRlcm4pIi8+PC9zdmc+\" x=\"0\" y=\"0\" width=\"2000\" height=\"1000\" result=\"image\"/><fetile in=\"image\" result=\"tile\"/><fecomposite operator=\"in\" in=\"flood1\" in2=\"tile\" result=\"tile2\"/><fegaussianblur in=\"SourceAlpha\" stddeviation=\"10\" result=\"blur\"/><fecomposite operator=\"in\" in=\"tile2\" in2=\"blur\" result=\"cloud\"/><femorphology operator=\"dilate\" radius=\"2\" in=\"SourceAlpha\" result=\"dilate\"/><fecomposite operator=\"in\" in=\"flood2\" in2=\"dilate\" result=\"base\"/><femerge><femergenode in=\"cloud\"/><femergenode in=\"base\"/><femergenode in=\"SourceGraphic\"/></femerge></filter></defs></svg></div><p class=\"xsj_paragraph xsj_paragraph_level_0\"></p><div class=\"toc mindmap_toc mindmap_container\" data-vdom-skip=\"true\" data-info=\"direction=lr\" data-hash=\"98d2884acb2a30cb0a86250e4b999ff4_mindmap_toc\"><div class=\"xsj_mindmap xsj_mindmap_toc\"><svg id=\"xsj_mindmap_toc_1663465472201\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" version=\"1.1\" class=\"xsj_svg_viewbox\" style=\"max-width:961px;max-height:522px;\" viewbox=\"0 0 961 522\" width=\"100%\" height=\"100%\"><g transform=\"translate(356,283) scale(1)\"><g class=\"markmap-link\" style=\"fill:none;\"><path stroke=\"#109618\" stroke-width=\"2\" d=\"M268,-149 L273,-149 C309,-149 304,-73 340,-73 L342,-73\"/><polygon class=\"markmap-link-polygon\" stroke-width=\"0\" transform=\"translate(268, -149)\" points=\"0,-2 5,0 0,2 -5,0\" style=\"fill: white;\"/><g transform=\"translate(340,-73)\"><path class=\"markmap-node-path\" d=\"M0,0L89,0\" stroke-width=\"2\" stroke=\"#109618\"/><polygon class=\"markmap-node-polygon\" stroke-width=\"0\" transform=\"translate(89, 0)\" points=\"0,-1 5,0 0,1 -5,0\" style=\"fill: rgb(16, 150, 24);\"/></g></g><g class=\"markmap-link\" style=\"fill:none;\"><path stroke=\"#109618\" stroke-width=\"2\" d=\"M268,-149 L273,-149 C309,-149 304,-147 340,-147 L342,-147\"/><polygon class=\"markmap-link-polygon\" stroke-width=\"0\" transform=\"translate(268, -149)\" points=\"0,-2 5,0 0,2 -5,0\" style=\"fill: white;\"/><g transform=\"translate(340,-147)\"><path class=\"markmap-node-path\" d=\"M0,0L164,0\" stroke-width=\"2\" stroke=\"#109618\"/><polygon class=\"markmap-node-polygon\" stroke-width=\"0\" transform=\"translate(164, 0)\" points=\"0,-1 5,0 0,1 -5,0\" style=\"fill: rgb(16, 150, 24);\"/></g></g><g class=\"markmap-link\" style=\"fill:none;\"><path stroke=\"#109618\" stroke-width=\"2\" d=\"M268,-149 L273,-149 C309,-149 304,-221 340,-221 L342,-221\"/><polygon class=\"markmap-link-polygon\" stroke-width=\"0\" transform=\"translate(268, -149)\" points=\"0,-2 5,0 0,2 -5,0\" style=\"fill: white;\"/><g transform=\"translate(340,-221)\"><path class=\"markmap-node-path\" d=\"M0,0L89,0\" stroke-width=\"2\" stroke=\"#109618\"/><polygon class=\"markmap-node-polygon\" stroke-width=\"0\" transform=\"translate(89, 0)\" points=\"0,-1 5,0 0,1 -5,0\" style=\"fill: rgb(16, 150, 24);\"/></g></g><g class=\"markmap-link\" style=\"fill:none;\"><path stroke=\"#ff9900\" stroke-width=\"2\" d=\"M268,36 L273,36 C309,36 304,75 340,75 L342,75\"/><polygon class=\"markmap-link-polygon\" stroke-width=\"0\" transform=\"translate(268, 36)\" points=\"0,-2 5,0 0,2 -5,0\" style=\"fill: white;\"/><g transform=\"translate(340,75)\"><path class=\"markmap-node-path\" d=\"M0,0L104,0\" stroke-width=\"2\" stroke=\"#ff9900\"/><polygon class=\"markmap-node-polygon\" stroke-width=\"0\" transform=\"translate(104, 0)\" points=\"0,-1 5,0 0,1 -5,0\" style=\"fill: rgb(255, 153, 0);\"/></g></g><g class=\"markmap-link\" style=\"fill:none;\"><path stroke=\"#ff9900\" stroke-width=\"2\" d=\"M268,36 L273,36 C309,36 304,1 340,1 L342,1\"/><polygon class=\"markmap-link-polygon\" stroke-width=\"0\" transform=\"translate(268, 36)\" points=\"0,-2 5,0 0,2 -5,0\" style=\"fill: white;\"/><g transform=\"translate(340,1)\"><path class=\"markmap-node-path\" d=\"M0,0L216,0\" stroke-width=\"2\" stroke=\"#ff9900\"/><polygon class=\"markmap-node-polygon\" stroke-width=\"0\" transform=\"translate(216, 0)\" points=\"0,-1 5,0 0,1 -5,0\" style=\"fill: rgb(255, 153, 0);\"/></g></g><g class=\"markmap-link\" style=\"fill:none;\"><path stroke=\"#dc3912\" stroke-width=\"2\" d=\"M308,149 L313,149 C349,149 344,151 380,151 L382,151\"/><polygon class=\"markmap-link-polygon\" stroke-width=\"0\" transform=\"translate(308, 149)\" points=\"0,-2 5,0 0,2 -5,0\" style=\"fill: white;\"/><g transform=\"translate(380,151)\"><path class=\"markmap-node-path\" d=\"M0,0L134,0\" stroke-width=\"2\" stroke=\"#dc3912\"/><polygon class=\"markmap-node-polygon\" stroke-width=\"0\" transform=\"translate(134, 0)\" points=\"0,-1 5,0 0,1 -5,0\" style=\"fill: rgb(220, 57, 18);\"/></g></g><g class=\"markmap-link\" style=\"fill:none;\"><path stroke=\"#dc3912\" stroke-width=\"4\" d=\"M120,-47.75 L125,-47.75 C197,-47.75 192,149 228,149 L230,149\"/><polygon class=\"markmap-link-polygon\" stroke-width=\"0\" transform=\"translate(120, -47.75)\" points=\"0,-3 5,0 0,3 -5,0\" style=\"fill: white;\"/><g transform=\"translate(228,149)\"><path class=\"markmap-node-path\" d=\"M0,0L79,0\" stroke-width=\"4\" stroke=\"#dc3912\"/><polygon class=\"markmap-node-polygon\" stroke-width=\"0\" transform=\"translate(79, 0)\" points=\"0,-2 5,0 0,2 -5,0\" style=\"fill: rgb(220, 57, 18);\"/></g></g><g class=\"markmap-link\" style=\"fill:none;\"><path stroke=\"#ff9900\" stroke-width=\"4\" d=\"M120,-47.75 L125,-47.75 C197,-47.75 192,36 228,36 L230,36\"/><polygon class=\"markmap-link-polygon\" stroke-width=\"0\" transform=\"translate(120, -47.75)\" points=\"0,-3 5,0 0,3 -5,0\" style=\"fill: white;\"/><g transform=\"translate(228,36)\"><path class=\"markmap-node-path\" d=\"M0,0L39,0\" stroke-width=\"4\" stroke=\"#ff9900\"/><polygon class=\"markmap-node-polygon\" stroke-width=\"0\" transform=\"translate(39, 0)\" points=\"0,-2 5,0 0,2 -5,0\" style=\"fill: rgb(255, 153, 0);\"/></g></g><g class=\"markmap-link\" style=\"fill:none;\"><path stroke=\"#109618\" stroke-width=\"4\" d=\"M120,-47.75 L125,-47.75 C197,-47.75 192,-149 228,-149 L230,-149\"/><polygon class=\"markmap-link-polygon\" stroke-width=\"0\" transform=\"translate(120, -47.75)\" points=\"0,-3 5,0 0,3 -5,0\" style=\"fill: white;\"/><g transform=\"translate(228,-149)\"><path class=\"markmap-node-path\" d=\"M0,0L39,0\" stroke-width=\"4\" stroke=\"#109618\"/><polygon class=\"markmap-node-polygon\" stroke-width=\"0\" transform=\"translate(39, 0)\" points=\"0,-2 5,0 0,2 -5,0\" style=\"fill: rgb(16, 150, 24);\"/></g></g><g class=\"markmap-link\" style=\"fill:none;\"><path stroke=\"#3366cc\" stroke-width=\"4\" d=\"M120,-47.75 L125,-47.75 C197,-47.75 192,-227 228,-227 L230,-227\"/><polygon class=\"markmap-link-polygon\" stroke-width=\"0\" transform=\"translate(120, -47.75)\" points=\"0,-3 5,0 0,3 -5,0\" style=\"fill: white;\"/><g transform=\"translate(228,-227)\"><path class=\"markmap-node-path\" d=\"M0,0L39,0\" stroke-width=\"4\" stroke=\"#3366cc\"/><polygon class=\"markmap-node-polygon\" stroke-width=\"0\" transform=\"translate(39, 0)\" points=\"0,-2 5,0 0,2 -5,0\" style=\"fill: rgb(51, 102, 204);\"/></g></g><g class=\"markmap-node markmap-root-node\" transform=\"translate(-264,-47.75)\"><polygon class=\"markmap-node-polygon\" stroke-width=\"0\" transform=\"translate(383, 0)\" points=\"0,-3 5,0 0,3 -5,0\" style=\"fill: rgb(51, 102, 204);\"/><g transform=\"translate(1, -34)\"><rect class=\"markmap-node-rect\" rx=\"10\" ry=\"10\" height=\"68\" width=\"382\" fill=\"rgb(78, 156, 255)\" stroke=\"#3366cc\" stroke-width=\"1\"/><text class=\"markmap-node-text\" alignment-baseline=\"middle\" x=\"192\" y=\"38\" text-anchor=\"middle\" style=\"font: bolder 30px sans-serif; fill-opacity: 1; fill: rgb(255, 255, 255);\">小书匠自定义图床使用说明</text></g></g><g class=\"markmap-node\" transform=\"translate(228,149)\"><a xlink:href=\"#e5b8b8e8a781e997aee9a298_9\"><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 20px sans-serif; fill: rgb(220, 57, 18); stroke: white; stroke-width: 2px; cursor: pointer;\">常见问题</text><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 20px sans-serif; fill: rgb(220, 57, 18); cursor: pointer;\">常见问题</text></a></g><g class=\"markmap-node\" transform=\"translate(380,151)\"><a xlink:href=\"#e5a682e4bd95e5b8a6e8aea4e8af81e4b88ae4bca0e59bbee78987_10\"><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 15px sans-serif; fill: rgb(220, 57, 18); stroke: white; stroke-width: 2px; cursor: pointer;\">如何带认证上传图片</text><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 15px sans-serif; fill: rgb(220, 57, 18); cursor: pointer;\">如何带认证上传图片</text></a></g><g class=\"markmap-node\" transform=\"translate(228,36)\"><a xlink:href=\"#e7a4bae4be8b_6\"><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 20px sans-serif; fill: rgb(255, 153, 0); stroke: white; stroke-width: 2px; cursor: pointer;\">示例</text><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 20px sans-serif; fill: rgb(255, 153, 0); cursor: pointer;\">示例</text></a></g><g class=\"markmap-node\" transform=\"translate(340,75)\"><a xlink:href=\"#e5ae9ee78eb0e5a49ae59bbee5ba8ae58a9fe883bd_8\"><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 15px sans-serif; fill: rgb(255, 153, 0); stroke: white; stroke-width: 2px; cursor: pointer;\">实现多图床功能</text><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 15px sans-serif; fill: rgb(255, 153, 0); cursor: pointer;\">实现多图床功能</text></a></g><g class=\"markmap-node\" transform=\"translate(340,1)\"><a xlink:href=\"#e6b7bbe58aa0e4b880e4b8aae887aae5ae9ae4b9892020imageurl20e59bbee5ba8a_7\"><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 15px sans-serif; fill: rgb(255, 153, 0); stroke: white; stroke-width: 2px; cursor: pointer;\">添加一个自定义  imageURL 图床</text><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 15px sans-serif; fill: rgb(255, 153, 0); cursor: pointer;\">添加一个自定义  imageURL 图床</text></a></g><g class=\"markmap-node\" transform=\"translate(228,-149)\"><a xlink:href=\"#e6938de4bd9c_2\"><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 20px sans-serif; fill: rgb(16, 150, 24); stroke: white; stroke-width: 2px; cursor: pointer;\">操作</text><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 20px sans-serif; fill: rgb(16, 150, 24); cursor: pointer;\">操作</text></a></g><g class=\"markmap-node\" transform=\"translate(340,-73)\"><a xlink:href=\"#e8b083e8af95e980bbe8be91e4bba3e7a081_5\"><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 15px sans-serif; fill: rgb(16, 150, 24); stroke: white; stroke-width: 2px; cursor: pointer;\">调试逻辑代码</text><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 15px sans-serif; fill: rgb(16, 150, 24); cursor: pointer;\">调试逻辑代码</text></a></g><g class=\"markmap-node\" transform=\"translate(340,-147)\"><a xlink:href=\"#e4bba3e7a081e980bbe8be91e58f8ae79bb8e585b3e58f98e9878fe8afb4e6988e_4\"><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 15px sans-serif; fill: rgb(16, 150, 24); stroke: white; stroke-width: 2px; cursor: pointer;\">代码逻辑及相关变量说明</text><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 15px sans-serif; fill: rgb(16, 150, 24); cursor: pointer;\">代码逻辑及相关变量说明</text></a></g><g class=\"markmap-node\" transform=\"translate(340,-221)\"><a xlink:href=\"#e58f82e695b0e8aebee7bdaee8afb4e6988e_3\"><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 15px sans-serif; fill: rgb(16, 150, 24); stroke: white; stroke-width: 2px; cursor: pointer;\">参数设置说明</text><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 15px sans-serif; fill: rgb(16, 150, 24); cursor: pointer;\">参数设置说明</text></a></g><g class=\"markmap-node\" transform=\"translate(228,-227)\"><a xlink:href=\"#e6a682e8bfb0_1\"><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 20px sans-serif; fill: rgb(51, 102, 204); stroke: white; stroke-width: 2px; cursor: pointer;\">概述</text><text class=\"markmap-node-text\" y=\"-5\" text-anchor=\"start\" x=\"0\" style=\"fill-opacity: 1; font: 20px sans-serif; fill: rgb(51, 102, 204); cursor: pointer;\">概述</text></a></g><g class=\"annotation-group\"><g class=\"annotations\"/></g></g></svg></div></div><p></p>\n<h1 class=\"xsj_heading_hash xsj_heading xsj_heading_h1\" id=\"e6a682e8bfb0_1\"><div class=\"xiaoshujiang_element xsj_anchor\">\n  <a name=\"e6a682e8bfb0_1\" class=\"blank_anchor_name\"></a><a id=\"e6a682e8bfb0_1\" class=\"blank_anchor_id\"></a><a name=\"概述\" class=\"blank_anchor_name\"></a><a id=\"概述\" class=\"blank_anchor_id\"></a>\n</div>\n<span class=\"xsj_heading_content\">概述</span></h1>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">小书匠从 <code>7.4.0</code> 版本开始，提供了自定义图床功能。通过该功能，用户可以将图片上传到自己想要的图床系统上，再也不用受限于系统提供的默认几个有限图床。同时，通过自定义图床，还可以实现强大的多图床功能，即把一张图片上传到多个图床系统上。</p>\n<h1 class=\"xsj_heading_hash xsj_heading xsj_heading_h1\" id=\"e6938de4bd9c_2\"><div class=\"xiaoshujiang_element xsj_anchor\">\n  <a name=\"e6938de4bd9c_2\" class=\"blank_anchor_name\"></a><a id=\"e6938de4bd9c_2\" class=\"blank_anchor_id\"></a><a name=\"操作\" class=\"blank_anchor_name\"></a><a id=\"操作\" class=\"blank_anchor_id\"></a>\n</div>\n<span class=\"xsj_heading_content\">操作</span></h1>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">点击 <strong class=\"markdown_strong_asterisk\">小书匠主按钮&gt;绑定&gt;自定义图床</strong> , 进入自定义图床设置界面。</p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\"></p><div class=\"story_image_container story_block_image\"><div class=\"story_image\"><div class=\"gatsby-wrapper-image\" style=\"display:inline-block;max-width: 100%;width:932px; margin-left: auto; margin-right: auto;position:relative;\"><div style=\"width:100%;display:block;padding-bottom: 15.557939914163088%;\"></div><img class=\"background_image\" src=\"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='400'%20height='62'%3e%3cpath%20d='M156%2011l-2%202-1%202c1%203-1%203-16%207s-18%204-18%200v-2H64v5c0%205%200%205-3%205-5%200-11%201-11%203l4%201c10%200%2010%200%2010%204v4h55v-6c0-5%200-6%202-6l1-1c-1-1%2030-9%2036-9h4v-5l-2-4-2-1-2%201m19%201l-1%201v1l1%203c1%203%2012%204%2012%201l1-2v2c0%201%201%202%204%202%202%200%203%200%202-2-2-1%200-3%202-2l1%203%204%201h4V10h-4l-5%201h-12c-2-1-10-1-9%201m96-1l-1%205v4h7c5%200%207-1%208-2h1l1%202%201-1h2v-6c-2-1-2-1%200-1l-1-1c-5-2-8%200-8%204l-1%205V10h-4l-5%201m22%200l-1%202v1l1%203%201%202h7v-3c1-1%201-1%202%201%200%203%201%203%205%203h4V10h-4c-5%200-5%200-5%203v3l-2-3c-1-3-5-4-5-1h-1l-2-2v1M4%2019c0%205%200%206%203%209l3%202v-6h33V14l-20-1H4v6m62%2012v9h51v-6l-1-5h-1l1-1%201-3v-3H66v9m97%2015h-5c-4%200-5%200-5%202-1%202%200%202%203%202%206%201%2010%200%209-1l1-1%201%201%209%201h14c1%200%202%200%202-2s-1-3-3-1h-1c-2-1-14-2-15-1h-7l-1-1-2%201'%20fill='%23d3d3d3'%20fill-rule='evenodd'/%3e%3c/svg%3e\" style=\"position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"><img src=\"/static/7af3b117bc13f578cb0ff7ddc81c1ec9/f6f78/1558497025092.png\" data-vdom-skip=\"true\" data-vdom-cache=\"true\" alt=\"自定义图床\" title=\"自定义图床\" name=\"images/1558497025092.png\" data-src=\"./images/1558497025092.png\" class=\"front_image\" loading=\"lazy\" srcSet=\"/static/7af3b117bc13f578cb0ff7ddc81c1ec9/f6f78/1558497025092.png 932w\" sizes=\"(max-width: 932px) 100vw, 932px\" data-action=\"zoom\" style=\"max-width: 100%;position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"></div><br><div class=\"story_image_caption \">自定义图床</div></div></div><p></p>\n<h2 class=\"xsj_heading_hash xsj_heading xsj_heading_h2\" id=\"e58f82e695b0e8aebee7bdaee8afb4e6988e_3\"><div class=\"xiaoshujiang_element xsj_anchor\">\n  <a name=\"e58f82e695b0e8aebee7bdaee8afb4e6988e_3\" class=\"blank_anchor_name\"></a><a id=\"e58f82e695b0e8aebee7bdaee8afb4e6988e_3\" class=\"blank_anchor_id\"></a><a name=\"参数设置说明\" class=\"blank_anchor_name\"></a><a id=\"参数设置说明\" class=\"blank_anchor_id\"></a>\n</div>\n<span class=\"xsj_heading_content\">参数设置说明</span></h2>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\"></p><div class=\"story_image_container story_block_image\"><div class=\"story_image\"><div class=\"gatsby-wrapper-image\" style=\"display:inline-block;max-width: 100%;width:732px; margin-left: auto; margin-right: auto;position:relative;\"><div style=\"width:100%;display:block;padding-bottom: 66.93989071038253%;\"></div><img class=\"background_image\" src=\"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='400'%20height='268'%3e%3cpath%20d='M7%204c-3%200-4%202-3%206%200%202%201%203%205%203l4-1h1c2%202%2011%201%2012-1l2-2%202%202c1%202%202%202%207%202l6-1-2-1-3-1%202-2%202-1-2-1-2-2h-1l-1%203c0%205-3%206-6%202l-2-4-1-1-1%202c1%201%200%203-1%204l-2%203v-3c0-5-2-8-5-6H7m37%201c-1%203%200%208%201%208l1-1h2c2%201%203%201%203-2%201-1%201-2-1-2-2-1-2-1%200-1%203%200%203%200%203%203s0%203%205%203h4V4h-4l-5%201h-1c-1-2-7-2-8%200m20%201l-1%206h1c2-2%205-2%205%200%201%201%201%201%201-1l-2-2-2-1%203-1c3%200%203%200%203%203s0%203%203%203c2%200%202%200%202-3%200-2%200-2%202%200v2l6%201c4%200%207%200%205-1-2%200-2%200%200-2s4-2%202%200c-1%202%203%203%2011%203%205%200%209%200%208-1l1-2c1-1%201-1%201%201%201%202%201%202%201%200%200-4%203-5%203-1%200%202%200%203%201%202l2-1v-1l-2-1c0-2%203-1%205%202l1%203v-3c0-4%202-4%203%200%201%202%204%203%204%200l-1-1c-2%202-2-1%200-3s2-2%202%200c0%204%200%206%202%206l1-1%202-1%201%201v1c3%200%203-2%202-5V4h-7l-7%201-1%201V4h-1c-2%202-7%201-7%200h-2c0-1-1-1-2%201l-2%201c0-2-1-2-3-2H93l-1%201c-2-2-18-1-19%200h-3l-1-2-1%202-1%201-1-1-1-2-1%203M6%2040c0%202%200%203-2%203s0%201%203%202l3-1-1-1-2-1%202-1%202%201c0%202%205%202%206%200h1l1%202%201-2h1c1%202%2011%203%2011%201%200-4-1-6-4-6l-3%201h-6l-2%201c-1-2-5-2-6%200l-4-1c-1-1-1%200-1%202m18%20118v4l1%203v-3c0-2%202-3%202%200%201%201%202%202%2010%202%205%200%209%200%208-1v-2c1-2%201-2%201%201%201%202%206%202%207%200h1c0%201%201%202%204%202l2-1v-1h1l2%201h2l1-1v1l1%201c2-1%203-5%201-6H54l1%201%201%201h-1l-2-1c0-1-2-2-7-2l-7%201h-1c-3-2-7-1-7%202l-1%202c-2%200-2-2-1-2v-2h-5m37%2019l-1%204h4c0%202%202%201%202-1v-2l1%202%202%202%202-2h1v1l1%201%202-2%201%201c1%201%201%201%201-1s0-2%202%200c1%201%202%202%206%202%205%200%206%200%204-5%200-3-6-3-6%200l-1-1H62c-1-1-1-1-1%201m30-2v4c0%202%201%203%203%203l3-1%201-1%201%201c-1%201%200%201%203%201%202%200%203%200%202-1v-1c1-1%202%200%202%201%200%202%208%202%209-1h1c0%202%201%202%202%202%202%200%202-1%202-3%200-3%200-4-3-4s-3%200-3%203c0%202%200%202-1%200l-1-2c-4-1-5%200-6%201h-1c0-3-7-3-7%200l-1%203v-3c0-2-5-3-6-2m76%201l-1%203c0%203%200%203%203%203s3%200%203-3c0-1%200-2%201-1v1l3%201%201%201%205%201%207-1-1-1v-2c1-2-2-3-5-2h-16M55%20186h-2v1c1%201%201%201%200%200h-8c-1%202%200%205%202%205h2l9%201h9v-3l-2-3-3%201h2l1%201h-1l-1%201v1l-2-2-1%201c-1%201-1%201-1-2%200-2%200-3-2-3l-2%201m163%200v1l-2%201c-2%200-2%200-1-1s1-1-2-1-5%202-3%205h1c0-2%200-2%201-1h1l1%201%202-1h1c-1%202%200%202%203%203%203%200%205-1%203-2v-2c1-1%201-1%201%201%201%202%202%202%206%202%205%200%206-1%205-2l1-1%201%203v1l2-4c0-3%200-3-3-3l-4%201-1-1h-13m92%200l-1%203v3l-1-3c-2-4-6-3-7%201%200%202%201%202%205%202l4-1%201-1%201%201v1l1-1v1h4l4-2%202-1c1-1%201%200%201%201-1%202-1%202%206%202l8-1v-2c1-2%202-2-9-2-11-1-12%200-12%202l-1%201-1-2c1-3-4-4-5-2M37%20200c0%203%200%203%203%203l4-2c1-1%201-1%201%201l1-1%201-2%201%202c0%202%201%202%202%201l1-3v-1l1%202%202%202%201-1%201-1%201%202v1l2-4v-2l-7-1c-6%200-7%201-7%202h-1c-3-3-7-2-7%202m16%207h-4c-4%200-4%200-4%203v3h7l7-1h1c0%202%205%201%206%200l1-1v1c-1%201%200%201%203%201%204%200%205-1%204-3%200-2-1-2-3-2l-2-1h-5l-4%201h-1c-1-2-6-3-6-1m74%200l-3%201-1%201v-1l-1-1-1%203v3h6c8-1%208-1%208-3l2%201c2%202%202%202%203%201h1c1%202%206%201%206%200s1-2%202-1v2c2%200%202-1%202-3%200-3%200-3-3-3-4%200-4%200-4%203l-1%202-1-3-1-2-1%202c0%201%200%202-1%201l-1-2c1-1-1-2-1-1h-10m133%200l-1%202c0%201-1%201-1-1-1-1-1-1-1%202l-1%203h7c5%200%208-1%209-2h1c-1%202%201%203%202%200l1%201h1l1-2%201%202c0%202%206%201%208-1h1l1%202%201-1h3c1%201%201%200%201-2%200-3%200-3-3-3l-4%201h-1c0-2-1-2-3-2-3%201-3%201-3%203l-2-1-2-1h-1l-2%201h-2v-1l-3-1c-2%201-4%201-4%203h-1v-2c1-1%201-1-1-1s-3%200-2%201m79%201v5l1-1%201-1c0%202%206%202%206%201h6l1-1c0%201%201%202%205%202%205%200%205-1%205-2-1-3-3-4-3-2l-1%202v-1l-1-2-1%202h-1c-1-1-2-2-3-1l-1-1-2-1-3%201h-6l-1%201v-1l-1-1-1%201m-217%2020c-1%203%200%207%201%205h5c2%202%204%201%204-1s0-2%201-1v2l9%201c8%200%209%200%209-2%200-3-3-5-4-4h-1c-1-2-1-1-2%204-1%201-1%200-1-2%200-3%200-3-3-3s-3%200-3%203c0%202%200%202-1%200l-1-2a1583%201583%200%2001-13%200m76%203l-1%203h5c3%200%204-1%205-2h1l1%201h1l6%201c3%200%203-1%203-3%200-3%200-3-2-3-3%200-4%200-4%203l-1%203-1-4c-2-3-2-3-2-1v3l-1-3-2-2v3c0%202-1%203-2%203-2%200-2%200-1-1%203-2%201-5-2-5-2%200-3%200-3%204m46-2v4c1%201%201%201%201-1s0-2%201-1c1%203%202%203%204%201l1-2v2l2%202%201-2c0-1%200-2%201-1l1-1v-1%205l2-1h1l4%201c3%200%203%200%203-4v-3h-7l-8%201h-1c0-2-5-1-6%201m38%202c0%203%203%205%204%202h1l3%201%203-1h1l5%201c5%200%205%200%205-3s-1-4-5-4l-2%203c0%202%200%202-1%201%200-3-2-4-4-2-1%201-1%201-1-1h-1l-1%204v1l-1-4c0-2-1-2-3-2-3%200-3%200-3%204m31-3v4c0%202%205%203%206%201h1c0%202%207%201%207%200%200-3%2011-3%2011-1%201%201%201%201%201-1-1-1%200-2%201-1v-1c0-2-1-2-3%200-1%201-10%202-10%200-1-2-7-2-7%200h-1c-1-2-4-2-6-1M67%20239c0%203%201%204%203%203l2-1-1%202-1%202%202-1c2-3%205-3%204%200h2c2-2%204-3%204-1l1%201%201-1c-1-1%200-1%201-1s2%200%201%202h1l4-1c3%201%205%200%205-3%200-2-1-2-3-2s-3%201-3%202l-1%201-1-1c1-2%200-2-7-2-6%200-9%201-6%202v1l-3-1c-3-2-5-2-5-1m52%2010l-1%203c0%202%200%202%202%202h9l1-2%201%201c-1%201%201%202%208%202%208%200%209%200%208-2h1l4%201c3%201%203%201%203-2%201-4%200-4-3-4l-4%202h-1c0-1-1-2-3-2-3%200-3%201-3%204l-4%201c-3%200-4%200-4-2l-1-2c-5-1-6-1-7%201%200%202%200%202-1%201-1-2-4-3-5-2m-12%2011l-5%201c-3%200-4%200-1%201%206%200%207%201%206%202s0%201%202%201l4-1v-1h1c0%202%201%202%204%202%202%200%203-1%203-2h4c1-2%201-2%201%200s0%202%201%201c0-2%202-2%203%200h7c0%202%205%201%206-1%202-3%201-4-2-4s-4%200-4%202h-1c-1-2-5-3-6-1h-3c0-1-1-2-2-1l-3%201h-1v-1l-3-1-4%202-1%201v-1l-1-1h-2c-1-1-2%200-3%201m82-1c-4%200-4%200-4%203s0%203%208%203l7-1v-1h1l1%202v-3c0-2%200-2%201%200l1%202h2c1%201%201%201%201-2s-3-5-6-2h-2c0-2-1-2-3-2l-7%201'%20fill='%23d3d3d3'%20fill-rule='evenodd'/%3e%3c/svg%3e\" style=\"position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"><img src=\"/static/202f14d791e11b5a5b8dab5b7abe5f95/d0cc0/1558497113127.png\" data-vdom-skip=\"true\" data-vdom-cache=\"true\" alt=\"自定义图床设置\" title=\"自定义图床设置\" name=\"images/1558497113127.png\" data-src=\"./images/1558497113127.png\" class=\"front_image\" loading=\"lazy\" srcSet=\"/static/202f14d791e11b5a5b8dab5b7abe5f95/d0cc0/1558497113127.png 732w\" sizes=\"(max-width: 732px) 100vw, 732px\" data-action=\"zoom\" style=\"max-width: 100%;position: absolute;top:0;left:0;width: 100%;height:100%;object-fit: cover;object-position: center;\"></div><br><div class=\"story_image_caption \">自定义图床设置</div></div></div><p></p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">由于自定义图床逻辑完全交给用户控制，因此系统只提供了一个参数设置，即代码逻辑。该值需要使用 javascript 语法完成图片上传的相关操作，并回调执行操作后的结果返回给小书匠系统。</p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\"><strong class=\"markdown_strong_asterisk\">注： 需要对 javascript 语法有一定的了解。</strong></p>\n<h2 class=\"xsj_heading_hash xsj_heading xsj_heading_h2\" id=\"e4bba3e7a081e980bbe8be91e58f8ae79bb8e585b3e58f98e9878fe8afb4e6988e_4\"><div class=\"xiaoshujiang_element xsj_anchor\">\n  <a name=\"e4bba3e7a081e980bbe8be91e58f8ae79bb8e585b3e58f98e9878fe8afb4e6988e_4\" class=\"blank_anchor_name\"></a><a id=\"e4bba3e7a081e980bbe8be91e58f8ae79bb8e585b3e58f98e9878fe8afb4e6988e_4\" class=\"blank_anchor_id\"></a><a name=\"代码逻辑及相关变量说明\" class=\"blank_anchor_name\"></a><a id=\"代码逻辑及相关变量说明\" class=\"blank_anchor_id\"></a>\n</div>\n<span class=\"xsj_heading_content\">代码逻辑及相关变量说明</span></h2>\n<ul class=\"markdown_ul\">\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_2\"><span class=\"xsj_placeholder_span\"></span>上传图片的代码需要使用 javascript 语言完成</p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_2\"><span class=\"xsj_placeholder_span\"></span>系统通过 javascript 的 <code>new Function</code> （<a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function\" class=\"xsj_link xsj_manu_link\">Function 定义</a> ）将自定义的上传逻辑封装在一个函数内，当用户触发上传图片的操作时，自动执行该函数</p>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_2\"><span class=\"xsj_placeholder_span\"></span>当该函数执行时，除了系统默认的全局变量，比如 <code>window</code>, <code>$</code>等用户可以直接使用外，还额外提供了 <code>filename</code>, <code>fileData</code>, <code>opts</code>, <code>callback</code> 四个变量</p>\n<ol class=\"markdown_ol\">\n<li><code>filename</code> 为上传文件的原始文件名，如果是从剪切板上传的图片，系统自己创建一个文件名, 格式为字符串</li>\n<li><code>fileData</code> 为上传文件的二进制内容，格式为 javascript 的 <code>blob</code> 对像</li>\n<li><code>opts</code> 提供了一些额外参数和方法， 目前提供了一个当前文件的 <code>md5</code> 值（opts.md5）和 <code>getPlugins</code> 方法 ( opts.getPlugins)</li>\n<li><span class=\"xsj_placeholder_span\"></span>callback 回调函数，当图片上传完成后，需要执行该回调函数，并提供相关的回调参数，比如生成的 url 地址</li>\n</ol>\n</li>\n<li>\n<p class=\"xsj_paragraph xsj_paragraph_level_2\"><span class=\"xsj_placeholder_span\"></span>在执行完上传图片后，需要用户执行一个回调函数 <code>callback</code>, 将代码操作权重新返回给小书匠，回调函数需包含以下参数</p>\n<ol class=\"markdown_ol\">\n<li><code>error</code> 如果上传图片失败，需要提供一个 <code>error</code> 描述失败原因，如果上传成功，直接提供一个 <code>null</code> 值即可</li>\n<li><code>newFilename</code> 如果用户想重新生成新的文件名，需要在这里返回该生成的新文件名，如果想保持不变，只需设置为 <code>null</code> 即可。</li>\n<li><code>url</code> 上传完图片后，返回的 <code>url</code> 地址</li>\n</ol>\n</li>\n</ul>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\"><strong class=\"markdown_strong_asterisk\">注：系统并没有对全局变量进行隔离， 因此用户可以直接拿到像 <code>window</code>, <code>$</code> 等对像，但需要注意的是，因为没有隔离变量，用户就可以随意修改全局对像的值，如果用户错误的修改了一个全局变量的值，会有系统崩溃的风险</strong></p>\n<h2 class=\"xsj_heading_hash xsj_heading xsj_heading_h2\" id=\"e8b083e8af95e980bbe8be91e4bba3e7a081_5\"><div class=\"xiaoshujiang_element xsj_anchor\">\n  <a name=\"e8b083e8af95e980bbe8be91e4bba3e7a081_5\" class=\"blank_anchor_name\"></a><a id=\"e8b083e8af95e980bbe8be91e4bba3e7a081_5\" class=\"blank_anchor_id\"></a><a name=\"调试逻辑代码\" class=\"blank_anchor_name\"></a><a id=\"调试逻辑代码\" class=\"blank_anchor_id\"></a>\n</div>\n<span class=\"xsj_heading_content\">调试逻辑代码</span></h2>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">可以通过 web 版本的小书匠，在 chrome 浏览器上将自定义的代码调试通过后，再将该代码逻辑应用到客户端上</p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">需要注意的是， web 版本存在跨域访问的限制，而客户端版本没有对该限制的要求。同时客户端版本还提供了对本地 nodejs 的 api 支持。</p>\n<h1 class=\"xsj_heading_hash xsj_heading xsj_heading_h1\" id=\"e7a4bae4be8b_6\"><div class=\"xiaoshujiang_element xsj_anchor\">\n  <a name=\"e7a4bae4be8b_6\" class=\"blank_anchor_name\"></a><a id=\"e7a4bae4be8b_6\" class=\"blank_anchor_id\"></a><a name=\"示例\" class=\"blank_anchor_name\"></a><a id=\"示例\" class=\"blank_anchor_id\"></a>\n</div>\n<span class=\"xsj_heading_content\">示例</span></h1>\n<h2 class=\"xsj_heading_hash xsj_heading xsj_heading_h2\" id=\"e6b7bbe58aa0e4b880e4b8aae887aae5ae9ae4b9892020imageurl20e59bbee5ba8a_7\"><div class=\"xiaoshujiang_element xsj_anchor\">\n  <a name=\"e6b7bbe58aa0e4b880e4b8aae887aae5ae9ae4b9892020imageurl20e59bbee5ba8a_7\" class=\"blank_anchor_name\"></a><a id=\"e6b7bbe58aa0e4b880e4b8aae887aae5ae9ae4b9892020imageurl20e59bbee5ba8a_7\" class=\"blank_anchor_id\"></a><a name=\"添加一个自定义-imageurl-图床\" class=\"blank_anchor_name\"></a><a id=\"添加一个自定义-imageurl-图床\" class=\"blank_anchor_id\"></a>\n</div>\n<span class=\"xsj_heading_content\">添加一个自定义  imageURL 图床</span></h2>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">使用的自定义图床服务为 <a href=\"https://www.xiaoz.me/doc/#/imgurl2/api\" class=\"xsj_link xsj_auto_link\">https://www.xiaoz.me/doc/#/imgurl2/api</a> , 用户可根据自己的实际需求选择自定义图床服务。</p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">相关代码逻辑如下，注意 <code>filename</code>, <code>fileData</code>, <code>opts</code>, <code>callback</code> 的变量要求</p>\n<div class=\"xiaoshujiang_code_container\"><div data-processed=\"true\" class=\"xiaoshujiang_pre\"><div class=\"language-javascript hljs code_linenums xiaoshujiang_code\"><ol start=\"1\" class=\"ol_linenums\" style=\"counter-reset: lines 0;\"><li class=\"li_linenum \" date-linenum=\"1\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">1</span><span class=\"hljs-keyword\">const</span> fd = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">FormData</span>();<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"2\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">2</span>fd.<span class=\"hljs-title function_\">append</span>(<span class=\"hljs-string\">'file'</span>, <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">File</span>([fileData], filename));<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"3\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">3</span>$.<span class=\"hljs-title function_\">ajax</span>({<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"4\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">4</span>\t<span class=\"hljs-attr\">type</span>: <span class=\"hljs-string\">'POST'</span>,<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"5\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">5</span>\t<span class=\"hljs-attr\">url</span>: <span class=\"hljs-string\">'http://test.imgurl.org/api/upload'</span>,<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"6\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">6</span>\t<span class=\"hljs-attr\">data</span>: fd,<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"7\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">7</span>\t<span class=\"hljs-attr\">processData</span>: <span class=\"hljs-literal\">false</span>,<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"8\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">8</span>\t<span class=\"hljs-attr\">contentType</span>: <span class=\"hljs-literal\">false</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"9\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">9</span>}).<span class=\"hljs-title function_\">done</span>(<span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">data</span>){<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"10\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">10</span>    <span class=\"hljs-keyword\">try</span>{<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"11\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">11</span>\t   data = <span class=\"hljs-title class_\">JSON</span>.<span class=\"hljs-title function_\">parse</span>(data);<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"12\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">12</span>\t} <span class=\"hljs-keyword\">catch</span>(e){}<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"13\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">13</span>\t<span class=\"hljs-keyword\">if</span> (data.<span class=\"hljs-property\">code</span> != <span class=\"hljs-number\">200</span>) {<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"14\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">14</span>\t   <span class=\"hljs-title function_\">callback</span>(<span class=\"hljs-string\">'上传失败'</span> + data.<span class=\"hljs-property\">msg</span>);<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"15\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">15</span>\t} <span class=\"hljs-keyword\">else</span> {<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"16\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">16</span>\t   <span class=\"hljs-title function_\">callback</span>(<span class=\"hljs-literal\">null</span>, filename, data.<span class=\"hljs-property\">url</span>, data);<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"17\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">17</span>\t}<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"18\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">18</span>}).<span class=\"hljs-title function_\">fail</span>(<span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">res, status, message</span>){<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"19\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">19</span>\t<span class=\"hljs-title function_\">callback</span>(<span class=\"hljs-string\">'上传资源失败:'</span> + message);<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"20\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">20</span>});<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li></ol></div></div></div>\n<h2 class=\"xsj_heading_hash xsj_heading xsj_heading_h2\" id=\"e5ae9ee78eb0e5a49ae59bbee5ba8ae58a9fe883bd_8\"><div class=\"xiaoshujiang_element xsj_anchor\">\n  <a name=\"e5ae9ee78eb0e5a49ae59bbee5ba8ae58a9fe883bd_8\" class=\"blank_anchor_name\"></a><a id=\"e5ae9ee78eb0e5a49ae59bbee5ba8ae58a9fe883bd_8\" class=\"blank_anchor_id\"></a><a name=\"实现多图床功能\" class=\"blank_anchor_name\"></a><a id=\"实现多图床功能\" class=\"blank_anchor_id\"></a>\n</div>\n<span class=\"xsj_heading_content\">实现多图床功能</span></h2>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">通过  <code>opts.getPlugins</code> 方法，获取到所有已经绑定的非自定义图床列表 <code>plugins</code>，遍历该图床列表，取得自己想要额外保存的第三方图床，比如 <code>const otherPlugin = plugins[0]</code>,  执行保存图片方法 <code>otnerPlugin.saveFile(filename, fileData, function(error, newFilename, fileData){});</code></p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">下面的例子演示了使用自定义的图床将图片上传到 <strong class=\"markdown_strong_asterisk\">imgurl</strong> 图床 , 并同时 将该图片上传到所有先前绑定的 smms 图床上。上传完成后，最终返回 <code>imgurl</code> 生成的地址做为文章内的显示地址。</p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">注：为了防止多图床嵌套，系统只允许用户拿到所有非自定义图床绑定的相关信息。也就是只列出小书匠内置支持的图床列表，比如 github, gitee, smms等图床。</p>\n<div class=\"xiaoshujiang_code_container\"><div data-processed=\"true\" class=\"xiaoshujiang_pre\"><div class=\"language-javascript hljs code_linenums xiaoshujiang_code\"><ol start=\"1\" class=\"ol_linenums\" style=\"counter-reset: lines 0;\"><li class=\"li_linenum \" date-linenum=\"1\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">1</span><span class=\"hljs-keyword\">const</span> fd = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">FormData</span>();<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"2\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">2</span>fd.<span class=\"hljs-title function_\">append</span>(<span class=\"hljs-string\">'file'</span>, <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">File</span>([fileData], filename));<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"3\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">3</span>plugins = opts.<span class=\"hljs-title function_\">getPlugins</span>(<span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">pluginObj</span>){<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"4\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">4</span>\t<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"5\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">5</span>\t<span class=\"hljs-comment\">// 可以通过  console.log(pluginObj) 在调试器里打印出所有支持的图床</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"6\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">6</span>\t<span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(pluginObj)<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"7\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">7</span>\t<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"8\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">8</span>    <span class=\"hljs-comment\">// pluginObj.id  里的 id 值对应绑定列表里显示的 id 值，</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"9\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">9</span>\t<span class=\"hljs-comment\">// 这里可以根据自己的业务逻辑需求，过滤 id, displayName 或者 name </span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"10\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">10</span>\t<span class=\"hljs-comment\">// id 为用户每次绑定一个新的第三方图床时，系统自动生成的一个值，可以在绑定列表里查看到</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"11\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">11</span>\t<span class=\"hljs-comment\">// displayName 是用户指定生成的一个名称，就是在绑定列表里，用户可以修改显示的名称</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"12\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">12</span>\t<span class=\"hljs-comment\">// name 系统预设的一个名称，比如 github 图床为 githubimg, gitee图床为 giteeimg 等</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"13\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">13</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"14\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">14</span>    <span class=\"hljs-keyword\">return</span> pluginObj.<span class=\"hljs-property\">name</span> === <span class=\"hljs-string\">'smms'</span>;<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"15\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">15</span>})<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"16\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">16</span><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">pluginUpload</span>(<span class=\"hljs-params\">plugin, cb</span>){<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"17\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">17</span>    plugin.<span class=\"hljs-title function_\">saveFile</span>(filename, fileData,  <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">err, _filename, _url, info</span>){<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"18\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">18</span>\t    <span class=\"hljs-keyword\">if</span> (err) {<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"19\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">19</span>\t\t    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">error</span>(<span class=\"hljs-string\">'使用图床 '</span> + plugin.<span class=\"hljs-property\">displayName</span> + <span class=\"hljs-string\">' 上传图片失败： '</span>  + err);<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"20\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">20</span>\t\t}<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"21\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">21</span>\t    <span class=\"hljs-title function_\">cb</span>();<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"22\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">22</span>\t});<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"23\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">23</span>}<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"24\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">24</span><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">allPluginUploaded</span>(<span class=\"hljs-params\"></span>){<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"25\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">25</span>\t<span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">'所有资源已经上传到相关图床上了'</span>);<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"26\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">26</span>}<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"27\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">27</span><span class=\"hljs-keyword\">async</span>.<span class=\"hljs-title function_\">mapLimit</span>(plugins, <span class=\"hljs-number\">10</span>, pluginUpload, allPluginUploaded);<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"28\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">28</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"29\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">29</span>$.<span class=\"hljs-title function_\">ajax</span>({<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"30\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">30</span>\t<span class=\"hljs-attr\">type</span>: <span class=\"hljs-string\">'POST'</span>,<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"31\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">31</span>\t<span class=\"hljs-attr\">url</span>: <span class=\"hljs-string\">'http://test.imgurl.org/api/upload'</span>,<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"32\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">32</span>\t<span class=\"hljs-attr\">data</span>: fd,<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"33\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">33</span>\t<span class=\"hljs-attr\">processData</span>: <span class=\"hljs-literal\">false</span>,<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"34\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">34</span>\t<span class=\"hljs-attr\">contentType</span>: <span class=\"hljs-literal\">false</span><span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"35\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">35</span>}).<span class=\"hljs-title function_\">done</span>(<span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">data</span>){<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"36\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">36</span>    <span class=\"hljs-keyword\">try</span>{<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"37\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">37</span>\t   data = <span class=\"hljs-title class_\">JSON</span>.<span class=\"hljs-title function_\">parse</span>(data);<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"38\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">38</span>\t} <span class=\"hljs-keyword\">catch</span>(e){}<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"39\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">39</span>\t<span class=\"hljs-keyword\">if</span> (data.<span class=\"hljs-property\">code</span> != <span class=\"hljs-number\">200</span>) {<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"40\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">40</span>\t   <span class=\"hljs-title function_\">callback</span>(<span class=\"hljs-string\">'上传失败'</span> + data.<span class=\"hljs-property\">msg</span>);<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"41\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">41</span>\t} <span class=\"hljs-keyword\">else</span> {<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"42\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">42</span>\t   <span class=\"hljs-title function_\">callback</span>(<span class=\"hljs-literal\">null</span>, filename, data.<span class=\"hljs-property\">url</span>, data);<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"43\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">43</span>\t}<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"44\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">44</span>}).<span class=\"hljs-title function_\">fail</span>(<span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">res, status, message</span>){<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"45\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">45</span>\t<span class=\"hljs-title function_\">callback</span>(<span class=\"hljs-string\">'上传资源失败:'</span> + message);<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"46\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">46</span>});<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li></ol></div></div></div>\n<h1 class=\"xsj_heading_hash xsj_heading xsj_heading_h1\" id=\"e5b8b8e8a781e997aee9a298_9\"><div class=\"xiaoshujiang_element xsj_anchor\">\n  <a name=\"e5b8b8e8a781e997aee9a298_9\" class=\"blank_anchor_name\"></a><a id=\"e5b8b8e8a781e997aee9a298_9\" class=\"blank_anchor_id\"></a><a name=\"常见问题\" class=\"blank_anchor_name\"></a><a id=\"常见问题\" class=\"blank_anchor_id\"></a>\n</div>\n<span class=\"xsj_heading_content\">常见问题</span></h1>\n<h2 class=\"xsj_heading_hash xsj_heading xsj_heading_h2\" id=\"e5a682e4bd95e5b8a6e8aea4e8af81e4b88ae4bca0e59bbee78987_10\"><div class=\"xiaoshujiang_element xsj_anchor\">\n  <a name=\"e5a682e4bd95e5b8a6e8aea4e8af81e4b88ae4bca0e59bbee78987_10\" class=\"blank_anchor_name\"></a><a id=\"e5a682e4bd95e5b8a6e8aea4e8af81e4b88ae4bca0e59bbee78987_10\" class=\"blank_anchor_id\"></a><a name=\"如何带认证上传图片\" class=\"blank_anchor_name\"></a><a id=\"如何带认证上传图片\" class=\"blank_anchor_id\"></a>\n</div>\n<span class=\"xsj_heading_content\">如何带认证上传图片</span></h2>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">可以通过自定义  headers ， url params  或者添加额外 body form 的上传信息，来达到上传图片时，带上认证信息。</p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">比如前面的两个例子里，使用了 jQuery 的 ajax 函数， 想要带上 headers, 可以参考下面的代码</p>\n<div class=\"xiaoshujiang_code_container\"><div data-processed=\"true\" class=\"xiaoshujiang_pre\"><div class=\"nohighlight hljs code_linenums xiaoshujiang_code\"><ol start=\"1\" class=\"ol_linenums\" style=\"counter-reset: lines 0;\"><li class=\"li_linenum \" date-linenum=\"1\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">1</span>$.ajax({<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"2\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">2</span>\ttype: 'POST',<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"3\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">3</span>\turl: 'http://test.imgurl.org/api/upload',<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"4\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">4</span>\tdata: fd,<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"5\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">5</span>\tprocessData: false,<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"6\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">6</span>\tcontentType: false,<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"7\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">7</span>\theaders: {<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"8\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">8</span>        \"My-First-Header\":\"first value\",<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"9\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">9</span>        \"My-Second-Header\":\"second value\"<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"10\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">10</span>    }<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li><li class=\"li_linenum \" date-linenum=\"11\"><span class=\"li_linenum_before_span li_linenum_before_span_hide\">11</span>})<span style=\"user-select:none;display:none;\">&nbsp;</span><br class=\"code_line_break_hack_br\"><hr class=\"code_line_break_hack_hr code_line_break_hack\" style=\"margin:0;border:0;border-top:0;border-bottom:0;\"></li></ol></div></div></div>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">详细使用，可以参考该函数的<a href=\"http://api.jquery.com/jquery.ajax/\" class=\"xsj_link xsj_manu_link\">说明</a></p>\n<p class=\"xsj_paragraph xsj_paragraph_level_0\">用户也可以使用 HTML5 提供的 fetch 函数，实现 ajax 请求。</p>\n</div>\n\n","excerpt":"小书匠从 7.4.0 版本开始，提供了自定义图床功能。通过该功能，用户可以将图片上传到自己想要的图床系统上，再也不用受限于系统提供的默认几个有限图床。同时，通过自定义图床，还可以实现强大的多图床功能，即把一张图片上传到多个图床系统上。\n点击 小书匠主按钮&gt;绑定&gt;自定义...","docType":"blogs","title":"小书匠自定义图床使用说明","customCss":"","createDate":"May 22, 2019","updateDate":"October 02, 2019","tags":["图床","自定义","小书匠"],"haveCover":false,"cover":{"childImageSharp":{"fluid":{"tracedSVG":"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='400'%20height='300'%3e%3cpath%20d='M389%2026l-12%2017-11%204-11%204c-1%200-2%208-2%2017l-2%2017-15-2-14-2-5%2013c-5%2011-7%2015-7%2012l-3-8a432%20432%200%2001-10-23l-5%2016-5%2017-7%201h-30l-6%208-6%209-19%207-18%208-3%207c-3%207-5%209-15%2019l-15%2016-12%209-9%205-8%2019c-8%2017-8%2019-8%2022%202%206%201%206-9%209l-9%202-10%2014c-12%2016-12%2014-11%2027v10h308V10l-11%2016'%20fill='%23d3d3d3'%20fill-rule='evenodd'/%3e%3c/svg%3e","aspectRatio":1.3333333333333333,"src":"/static/110714db7e82e834196f7a1847d4db72/a8378/cover6.png","srcSet":"/static/110714db7e82e834196f7a1847d4db72/a8378/cover6.png 1024w","sizes":"(max-width: 1024px) 100vw, 1024px","originalImg":"/static/110714db7e82e834196f7a1847d4db72/a8378/cover6.png"}}},"meta":{"title":"小书匠自定义图床使用说明","tags":"图床,自定义,小书匠"}}},"pageContext":{"slug":"images/custom_images_manager","zipPath":"/home/runner/work/roadbike/roadbike/src/xsjposts/blogs/小书匠自定义图床使用说明.zip","pdfPath":"/home/runner/work/roadbike/roadbike/src/xsjposts/blogs/小书匠自定义图床使用说明.pdf","sidebarItems":[{"title":"概述","link":"/blog/images/custom_images_manager#e6a682e8bfb0_1","hash":"e6a682e8bfb0_1","parentUid":"","uid":"概述","key":"blog"},{"title":"操作","link":"/blog/images/custom_images_manager#e6938de4bd9c_2","items":[{"title":"参数设置说明","link":"/blog/images/custom_images_manager#e58f82e695b0e8aebee7bdaee8afb4e6988e_3","hash":"e58f82e695b0e8aebee7bdaee8afb4e6988e_3","parentUid":"操作","uid":"操作___参数设置说明"},{"title":"代码逻辑及相关变量说明","link":"/blog/images/custom_images_manager#e4bba3e7a081e980bbe8be91e58f8ae79bb8e585b3e58f98e9878fe8afb4e6988e_4","hash":"e4bba3e7a081e980bbe8be91e58f8ae79bb8e585b3e58f98e9878fe8afb4e6988e_4","parentUid":"操作","uid":"操作___代码逻辑及相关变量说明"},{"title":"调试逻辑代码","link":"/blog/images/custom_images_manager#e8b083e8af95e980bbe8be91e4bba3e7a081_5","hash":"e8b083e8af95e980bbe8be91e4bba3e7a081_5","parentUid":"操作","uid":"操作___调试逻辑代码"}],"hash":"e6938de4bd9c_2","parentUid":"","uid":"操作","key":"blog"},{"title":"示例","link":"/blog/images/custom_images_manager#e7a4bae4be8b_6","items":[{"title":"添加一个自定义-imageurl-图床","link":"/blog/images/custom_images_manager#e6b7bbe58aa0e4b880e4b8aae887aae5ae9ae4b9892020imageurl20e59bbee5ba8a_7","hash":"e6b7bbe58aa0e4b880e4b8aae887aae5ae9ae4b9892020imageurl20e59bbee5ba8a_7","parentUid":"示例","uid":"示例___添加一个自定义-imageurl-图床"},{"title":"实现多图床功能","link":"/blog/images/custom_images_manager#e5ae9ee78eb0e5a49ae59bbee5ba8ae58a9fe883bd_8","hash":"e5ae9ee78eb0e5a49ae59bbee5ba8ae58a9fe883bd_8","parentUid":"示例","uid":"示例___实现多图床功能"}],"hash":"e7a4bae4be8b_6","parentUid":"","uid":"示例","key":"blog"},{"title":"常见问题","link":"/blog/images/custom_images_manager#e5b8b8e8a781e997aee9a298_9","items":[{"title":"如何带认证上传图片","link":"/blog/images/custom_images_manager#e5a682e4bd95e5b8a6e8aea4e8af81e4b88ae4bca0e59bbee78987_10","hash":"e5a682e4bd95e5b8a6e8aea4e8af81e4b88ae4bca0e59bbee78987_10","parentUid":"常见问题","uid":"常见问题___如何带认证上传图片"}],"hash":"e5b8b8e8a781e997aee9a298_9","parentUid":"","uid":"常见问题","key":"blog"}],"isSidebarDisabled":true,"enableScrollSync":true,"prev":{"title":"思维脑图关联，范围，注释新功能","docType":"blogs","slug":"mindmap/extense"},"next":{"title":"小书匠邀请功能说明","docType":"blogs","slug":"user/invitation"},"related":[{"title":"8.1.4 升级日志","docType":"logs","slug":"version/v_8_1_4"},{"title":"4.2.0 升级日志","docType":"logs","slug":"version/v_4_2_0"},{"title":"1.9.0 升级日志","docType":"logs","slug":"version/v_1_9_0"},{"title":"演示数学公式自动提示功能","docType":"blogs","slug":"story-writer/mathjax-showhint"},{"title":"小书匠语法说明之无序列表","docType":"docs","slug":"grammar/common/ul"},{"title":"印象笔记标签树显示功能","docType":"blogs","slug":"evernote/tags_support"}]}}}